{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/shabareesharyan/notebookd87ef032a9?scriptVersionId=105400118\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"markdown","id":"49ac00c4","metadata":{"id":"981bjX4F1aqk","papermill":{"duration":0.009387,"end_time":"2022-09-11T09:58:47.243942","exception":false,"start_time":"2022-09-11T09:58:47.234555","status":"completed"},"tags":[]},"source":["Importing Dependencies"]},{"cell_type":"code","execution_count":1,"id":"dfbcc44f","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:47.263612Z","iopub.status.busy":"2022-09-11T09:58:47.262964Z","iopub.status.idle":"2022-09-11T09:58:48.339064Z","shell.execute_reply":"2022-09-11T09:58:48.337887Z"},"id":"CQhnlZopWGdl","papermill":{"duration":1.089637,"end_time":"2022-09-11T09:58:48.341854","exception":false,"start_time":"2022-09-11T09:58:47.252217","status":"completed"},"tags":[]},"outputs":[],"source":["import sklearn as sklearn"]},{"cell_type":"code","execution_count":2,"id":"4b9b1f1d","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.361959Z","iopub.status.busy":"2022-09-11T09:58:48.359609Z","iopub.status.idle":"2022-09-11T09:58:48.516555Z","shell.execute_reply":"2022-09-11T09:58:48.515413Z"},"id":"FLqVcw-T0LWB","papermill":{"duration":0.169369,"end_time":"2022-09-11T09:58:48.519599","exception":false,"start_time":"2022-09-11T09:58:48.35023","status":"completed"},"tags":[]},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.model_selection import train_test_split\n","from sklearn import svm\n","from sklearn.metrics import accuracy_score"]},{"cell_type":"markdown","id":"998cad82","metadata":{"id":"36vFRXDb418r","papermill":{"duration":0.007894,"end_time":"2022-09-11T09:58:48.535665","exception":false,"start_time":"2022-09-11T09:58:48.527771","status":"completed"},"tags":[]},"source":["Collecting Data and Analysing it"]},{"cell_type":"code","execution_count":3,"id":"a66111b2","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.553561Z","iopub.status.busy":"2022-09-11T09:58:48.553152Z","iopub.status.idle":"2022-09-11T09:58:48.57411Z","shell.execute_reply":"2022-09-11T09:58:48.573208Z"},"id":"I_U5K2WF46vw","papermill":{"duration":0.032829,"end_time":"2022-09-11T09:58:48.576885","exception":false,"start_time":"2022-09-11T09:58:48.544056","status":"completed"},"tags":[]},"outputs":[],"source":["# loading the diabetes data set\n","loan = pd.read_csv('../input/loan-data-set/loan_data_set.csv')"]},{"cell_type":"code","execution_count":4,"id":"cb6b3700","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.594878Z","iopub.status.busy":"2022-09-11T09:58:48.59448Z","iopub.status.idle":"2022-09-11T09:58:48.6337Z","shell.execute_reply":"2022-09-11T09:58:48.632378Z"},"id":"E353QMEx47L5","outputId":"d34025bd-f180-494c-9417-1e4c9f487e71","papermill":{"duration":0.050655,"end_time":"2022-09-11T09:58:48.635941","exception":false,"start_time":"2022-09-11T09:58:48.585286","status":"completed"},"scrolled":true,"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Loan_ID</th>\n","      <th>Gender</th>\n","      <th>Married</th>\n","      <th>Dependents</th>\n","      <th>Education</th>\n","      <th>Self_Employed</th>\n","      <th>ApplicantIncome</th>\n","      <th>CoapplicantIncome</th>\n","      <th>LoanAmount</th>\n","      <th>Loan_Amount_Term</th>\n","      <th>Credit_History</th>\n","      <th>Property_Area</th>\n","      <th>Loan_Status</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>LP001002</td>\n","      <td>Male</td>\n","      <td>No</td>\n","      <td>0</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>5849</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Urban</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>LP001003</td>\n","      <td>Male</td>\n","      <td>Yes</td>\n","      <td>1</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>4583</td>\n","      <td>1508.0</td>\n","      <td>128.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Rural</td>\n","      <td>N</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>LP001005</td>\n","      <td>Male</td>\n","      <td>Yes</td>\n","      <td>0</td>\n","      <td>Graduate</td>\n","      <td>Yes</td>\n","      <td>3000</td>\n","      <td>0.0</td>\n","      <td>66.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Urban</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>LP001006</td>\n","      <td>Male</td>\n","      <td>Yes</td>\n","      <td>0</td>\n","      <td>Not Graduate</td>\n","      <td>No</td>\n","      <td>2583</td>\n","      <td>2358.0</td>\n","      <td>120.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Urban</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>LP001008</td>\n","      <td>Male</td>\n","      <td>No</td>\n","      <td>0</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>6000</td>\n","      <td>0.0</td>\n","      <td>141.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Urban</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>609</th>\n","      <td>LP002978</td>\n","      <td>Female</td>\n","      <td>No</td>\n","      <td>0</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>2900</td>\n","      <td>0.0</td>\n","      <td>71.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Rural</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>610</th>\n","      <td>LP002979</td>\n","      <td>Male</td>\n","      <td>Yes</td>\n","      <td>3+</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>4106</td>\n","      <td>0.0</td>\n","      <td>40.0</td>\n","      <td>180.0</td>\n","      <td>1.0</td>\n","      <td>Rural</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>611</th>\n","      <td>LP002983</td>\n","      <td>Male</td>\n","      <td>Yes</td>\n","      <td>1</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>8072</td>\n","      <td>240.0</td>\n","      <td>253.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Urban</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>612</th>\n","      <td>LP002984</td>\n","      <td>Male</td>\n","      <td>Yes</td>\n","      <td>2</td>\n","      <td>Graduate</td>\n","      <td>No</td>\n","      <td>7583</td>\n","      <td>0.0</td>\n","      <td>187.0</td>\n","      <td>360.0</td>\n","      <td>1.0</td>\n","      <td>Urban</td>\n","      <td>Y</td>\n","    </tr>\n","    <tr>\n","      <th>613</th>\n","      <td>LP002990</td>\n","      <td>Female</td>\n","      <td>No</td>\n","      <td>0</td>\n","      <td>Graduate</td>\n","      <td>Yes</td>\n","      <td>4583</td>\n","      <td>0.0</td>\n","      <td>133.0</td>\n","      <td>360.0</td>\n","      <td>0.0</td>\n","      <td>Semiurban</td>\n","      <td>N</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>614 rows Ã— 13 columns</p>\n","</div>"],"text/plain":["      Loan_ID  Gender Married Dependents     Education Self_Employed  \\\n","0    LP001002    Male      No          0      Graduate            No   \n","1    LP001003    Male     Yes          1      Graduate            No   \n","2    LP001005    Male     Yes          0      Graduate           Yes   \n","3    LP001006    Male     Yes          0  Not Graduate            No   \n","4    LP001008    Male      No          0      Graduate            No   \n","..        ...     ...     ...        ...           ...           ...   \n","609  LP002978  Female      No          0      Graduate            No   \n","610  LP002979    Male     Yes         3+      Graduate            No   \n","611  LP002983    Male     Yes          1      Graduate            No   \n","612  LP002984    Male     Yes          2      Graduate            No   \n","613  LP002990  Female      No          0      Graduate           Yes   \n","\n","     ApplicantIncome  CoapplicantIncome  LoanAmount  Loan_Amount_Term  \\\n","0               5849                0.0         NaN             360.0   \n","1               4583             1508.0       128.0             360.0   \n","2               3000                0.0        66.0             360.0   \n","3               2583             2358.0       120.0             360.0   \n","4               6000                0.0       141.0             360.0   \n","..               ...                ...         ...               ...   \n","609             2900                0.0        71.0             360.0   \n","610             4106                0.0        40.0             180.0   \n","611             8072              240.0       253.0             360.0   \n","612             7583                0.0       187.0             360.0   \n","613             4583                0.0       133.0             360.0   \n","\n","     Credit_History Property_Area Loan_Status  \n","0               1.0         Urban           Y  \n","1               1.0         Rural           N  \n","2               1.0         Urban           Y  \n","3               1.0         Urban           Y  \n","4               1.0         Urban           Y  \n","..              ...           ...         ...  \n","609             1.0         Rural           Y  \n","610             1.0         Rural           Y  \n","611             1.0         Urban           Y  \n","612             1.0         Urban           Y  \n","613             0.0     Semiurban           N  \n","\n","[614 rows x 13 columns]"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["#printing the first 5 rows of the data set\n","loan"]},{"cell_type":"code","execution_count":5,"id":"1758c274","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.654733Z","iopub.status.busy":"2022-09-11T09:58:48.653997Z","iopub.status.idle":"2022-09-11T09:58:48.661043Z","shell.execute_reply":"2022-09-11T09:58:48.659903Z"},"id":"aovf37yw6dxS","outputId":"352352dc-d31f-4f44-81a0-9ab43254ea4d","papermill":{"duration":0.018889,"end_time":"2022-09-11T09:58:48.663426","exception":false,"start_time":"2022-09-11T09:58:48.644537","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(614, 13)"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["# getting the number of rows and columns in the dataset\n","loan.shape"]},{"cell_type":"code","execution_count":6,"id":"9e38f319","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.683546Z","iopub.status.busy":"2022-09-11T09:58:48.68252Z","iopub.status.idle":"2022-09-11T09:58:48.719206Z","shell.execute_reply":"2022-09-11T09:58:48.718048Z"},"id":"Wj3epASL65_E","outputId":"84e6b351-4d92-41b3-f2c9-6802566be6b0","papermill":{"duration":0.048499,"end_time":"2022-09-11T09:58:48.721442","exception":false,"start_time":"2022-09-11T09:58:48.672943","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ApplicantIncome</th>\n","      <th>CoapplicantIncome</th>\n","      <th>LoanAmount</th>\n","      <th>Loan_Amount_Term</th>\n","      <th>Credit_History</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>614.000000</td>\n","      <td>614.000000</td>\n","      <td>592.000000</td>\n","      <td>600.00000</td>\n","      <td>564.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>5403.459283</td>\n","      <td>1621.245798</td>\n","      <td>146.412162</td>\n","      <td>342.00000</td>\n","      <td>0.842199</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>6109.041673</td>\n","      <td>2926.248369</td>\n","      <td>85.587325</td>\n","      <td>65.12041</td>\n","      <td>0.364878</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>150.000000</td>\n","      <td>0.000000</td>\n","      <td>9.000000</td>\n","      <td>12.00000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>2877.500000</td>\n","      <td>0.000000</td>\n","      <td>100.000000</td>\n","      <td>360.00000</td>\n","      <td>1.000000</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>3812.500000</td>\n","      <td>1188.500000</td>\n","      <td>128.000000</td>\n","      <td>360.00000</td>\n","      <td>1.000000</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>5795.000000</td>\n","      <td>2297.250000</td>\n","      <td>168.000000</td>\n","      <td>360.00000</td>\n","      <td>1.000000</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>81000.000000</td>\n","      <td>41667.000000</td>\n","      <td>700.000000</td>\n","      <td>480.00000</td>\n","      <td>1.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["       ApplicantIncome  CoapplicantIncome  LoanAmount  Loan_Amount_Term  \\\n","count       614.000000         614.000000  592.000000         600.00000   \n","mean       5403.459283        1621.245798  146.412162         342.00000   \n","std        6109.041673        2926.248369   85.587325          65.12041   \n","min         150.000000           0.000000    9.000000          12.00000   \n","25%        2877.500000           0.000000  100.000000         360.00000   \n","50%        3812.500000        1188.500000  128.000000         360.00000   \n","75%        5795.000000        2297.250000  168.000000         360.00000   \n","max       81000.000000       41667.000000  700.000000         480.00000   \n","\n","       Credit_History  \n","count      564.000000  \n","mean         0.842199  \n","std          0.364878  \n","min          0.000000  \n","25%          1.000000  \n","50%          1.000000  \n","75%          1.000000  \n","max          1.000000  "]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["# getting the statistical measures of the data\n","loan.describe()"]},{"cell_type":"code","execution_count":7,"id":"ab543d52","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.740432Z","iopub.status.busy":"2022-09-11T09:58:48.740017Z","iopub.status.idle":"2022-09-11T09:58:48.748805Z","shell.execute_reply":"2022-09-11T09:58:48.74769Z"},"id":"XI-j_YYN7RlH","outputId":"9c510abe-74d4-47d5-8c30-445368a2c4dc","papermill":{"duration":0.020805,"end_time":"2022-09-11T09:58:48.750944","exception":false,"start_time":"2022-09-11T09:58:48.730139","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Y    422\n","N    192\n","Name: Loan_Status, dtype: int64"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["loan['Loan_Status'].value_counts()"]},{"cell_type":"code","execution_count":8,"id":"0352a01c","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.770631Z","iopub.status.busy":"2022-09-11T09:58:48.769996Z","iopub.status.idle":"2022-09-11T09:58:48.786651Z","shell.execute_reply":"2022-09-11T09:58:48.785438Z"},"id":"9JBIUtHbeKYZ","outputId":"e3298a4c-3eb0-419b-e086-1d735bb112f1","papermill":{"duration":0.029265,"end_time":"2022-09-11T09:58:48.789075","exception":false,"start_time":"2022-09-11T09:58:48.75981","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ApplicantIncome</th>\n","      <th>CoapplicantIncome</th>\n","      <th>LoanAmount</th>\n","      <th>Loan_Amount_Term</th>\n","      <th>Credit_History</th>\n","    </tr>\n","    <tr>\n","      <th>Loan_Status</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>N</th>\n","      <td>5446.078125</td>\n","      <td>1877.807292</td>\n","      <td>151.220994</td>\n","      <td>344.064516</td>\n","      <td>0.541899</td>\n","    </tr>\n","    <tr>\n","      <th>Y</th>\n","      <td>5384.068720</td>\n","      <td>1504.516398</td>\n","      <td>144.294404</td>\n","      <td>341.072464</td>\n","      <td>0.981818</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["             ApplicantIncome  CoapplicantIncome  LoanAmount  Loan_Amount_Term  \\\n","Loan_Status                                                                     \n","N                5446.078125        1877.807292  151.220994        344.064516   \n","Y                5384.068720        1504.516398  144.294404        341.072464   \n","\n","             Credit_History  \n","Loan_Status                  \n","N                  0.541899  \n","Y                  0.981818  "]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["loan.groupby('Loan_Status').mean()"]},{"cell_type":"code","execution_count":9,"id":"231f8bfb","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.809508Z","iopub.status.busy":"2022-09-11T09:58:48.808736Z","iopub.status.idle":"2022-09-11T09:58:48.819114Z","shell.execute_reply":"2022-09-11T09:58:48.818204Z"},"id":"DUTyBonkhGjA","papermill":{"duration":0.023413,"end_time":"2022-09-11T09:58:48.821686","exception":false,"start_time":"2022-09-11T09:58:48.798273","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.preprocessing import LabelEncoder\n","\n","loan=loan.apply(LabelEncoder().fit_transform)"]},{"cell_type":"code","execution_count":10,"id":"6e060d8d","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.842039Z","iopub.status.busy":"2022-09-11T09:58:48.841588Z","iopub.status.idle":"2022-09-11T09:58:48.848315Z","shell.execute_reply":"2022-09-11T09:58:48.847399Z"},"id":"DUTyBonkhGjA","papermill":{"duration":0.019687,"end_time":"2022-09-11T09:58:48.850579","exception":false,"start_time":"2022-09-11T09:58:48.830892","status":"completed"},"tags":[]},"outputs":[],"source":["X = loan.drop(columns='Loan_Status',axis=1)\n","\n","Y = loan['Loan_Status']\n"]},{"cell_type":"markdown","id":"6fe3a207","metadata":{"id":"qAXJzuYj0k9z","papermill":{"duration":0.008766,"end_time":"2022-09-11T09:58:48.868443","exception":false,"start_time":"2022-09-11T09:58:48.859677","status":"completed"},"tags":[]},"source":["Data Standardization"]},{"cell_type":"code","execution_count":11,"id":"2945d094","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.88882Z","iopub.status.busy":"2022-09-11T09:58:48.888061Z","iopub.status.idle":"2022-09-11T09:58:48.893179Z","shell.execute_reply":"2022-09-11T09:58:48.892374Z"},"id":"np9xcWmYx5ls","papermill":{"duration":0.017842,"end_time":"2022-09-11T09:58:48.895402","exception":false,"start_time":"2022-09-11T09:58:48.87756","status":"completed"},"tags":[]},"outputs":[],"source":["scalar = StandardScaler()"]},{"cell_type":"code","execution_count":12,"id":"4d1ed2de","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.915957Z","iopub.status.busy":"2022-09-11T09:58:48.915212Z","iopub.status.idle":"2022-09-11T09:58:48.926601Z","shell.execute_reply":"2022-09-11T09:58:48.925702Z"},"id":"7YjqFsbL1GMm","outputId":"216154e1-333c-4fad-8e45-800c6163f3a5","papermill":{"duration":0.024375,"end_time":"2022-09-11T09:58:48.928771","exception":false,"start_time":"2022-09-11T09:58:48.904396","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["StandardScaler()"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["scalar.fit(X)"]},{"cell_type":"code","execution_count":13,"id":"e5d6fa13","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.949227Z","iopub.status.busy":"2022-09-11T09:58:48.948825Z","iopub.status.idle":"2022-09-11T09:58:48.955331Z","shell.execute_reply":"2022-09-11T09:58:48.954228Z"},"id":"bYV0i4kI5GZk","papermill":{"duration":0.019625,"end_time":"2022-09-11T09:58:48.957742","exception":false,"start_time":"2022-09-11T09:58:48.938117","status":"completed"},"tags":[]},"outputs":[],"source":["standardized_data=scalar.transform(X)"]},{"cell_type":"markdown","id":"754a4959","metadata":{"id":"PagjNHsD86Je","papermill":{"duration":0.009322,"end_time":"2022-09-11T09:58:48.976649","exception":false,"start_time":"2022-09-11T09:58:48.967327","status":"completed"},"tags":[]},"source":["Train Test Split\n"]},{"cell_type":"code","execution_count":14,"id":"f2fdfa8c","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:48.997663Z","iopub.status.busy":"2022-09-11T09:58:48.997262Z","iopub.status.idle":"2022-09-11T09:58:49.006354Z","shell.execute_reply":"2022-09-11T09:58:49.005467Z"},"id":"aEmYZSzf9CYb","papermill":{"duration":0.022744,"end_time":"2022-09-11T09:58:49.008697","exception":false,"start_time":"2022-09-11T09:58:48.985953","status":"completed"},"tags":[]},"outputs":[],"source":["X_train, X_test, Y_train, Y_test = train_test_split(X,Y, test_size = 0.2, stratify=Y, random_state=2)"]},{"cell_type":"code","execution_count":15,"id":"ecae95a2","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:49.029251Z","iopub.status.busy":"2022-09-11T09:58:49.028548Z","iopub.status.idle":"2022-09-11T09:58:49.035433Z","shell.execute_reply":"2022-09-11T09:58:49.034146Z"},"id":"cYAOSYF1-TkD","outputId":"8f73153c-c9c7-45b1-e42d-477e0124aef8","papermill":{"duration":0.020254,"end_time":"2022-09-11T09:58:49.038299","exception":false,"start_time":"2022-09-11T09:58:49.018045","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["(614, 12) (491, 12) (123, 12)\n"]}],"source":["print(X.shape, X_train.shape, X_test.shape)"]},{"cell_type":"markdown","id":"03b825f9","metadata":{"id":"tWDA60Ff-TIp","papermill":{"duration":0.009173,"end_time":"2022-09-11T09:58:49.057069","exception":false,"start_time":"2022-09-11T09:58:49.047896","status":"completed"},"tags":[]},"source":["Training the Model"]},{"cell_type":"code","execution_count":16,"id":"4a8fd4c4","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:49.077763Z","iopub.status.busy":"2022-09-11T09:58:49.076947Z","iopub.status.idle":"2022-09-11T09:58:49.082219Z","shell.execute_reply":"2022-09-11T09:58:49.08129Z"},"id":"Z1_Sm1Uy_fX6","papermill":{"duration":0.018232,"end_time":"2022-09-11T09:58:49.084522","exception":false,"start_time":"2022-09-11T09:58:49.06629","status":"completed"},"tags":[]},"outputs":[],"source":["classifier = svm.SVC(kernel='linear')"]},{"cell_type":"code","execution_count":17,"id":"5e137f55","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:49.105784Z","iopub.status.busy":"2022-09-11T09:58:49.104963Z","iopub.status.idle":"2022-09-11T09:58:49.950767Z","shell.execute_reply":"2022-09-11T09:58:49.949594Z"},"id":"JeobFGi__yND","outputId":"961b2dc6-1e43-4f94-8def-1d79c3bb3fbc","papermill":{"duration":0.859414,"end_time":"2022-09-11T09:58:49.953172","exception":false,"start_time":"2022-09-11T09:58:49.093758","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["SVC(kernel='linear')"]},"execution_count":17,"metadata":{},"output_type":"execute_result"}],"source":["#training the support vector Machine Classifier\n","classifier.fit(X_train, Y_train)"]},{"cell_type":"markdown","id":"9ee9a9b8","metadata":{"id":"k4V0Tes4Aj7j","papermill":{"duration":0.009086,"end_time":"2022-09-11T09:58:49.971802","exception":false,"start_time":"2022-09-11T09:58:49.962716","status":"completed"},"tags":[]},"source":["Model Evaluation"]},{"cell_type":"markdown","id":"fc5cf528","metadata":{"id":"H3_XVVtH-Caa","papermill":{"duration":0.009154,"end_time":"2022-09-11T09:58:49.990421","exception":false,"start_time":"2022-09-11T09:58:49.981267","status":"completed"},"tags":[]},"source":["Accuracy Score"]},{"cell_type":"code","execution_count":18,"id":"159af06a","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.011052Z","iopub.status.busy":"2022-09-11T09:58:50.010599Z","iopub.status.idle":"2022-09-11T09:58:50.023618Z","shell.execute_reply":"2022-09-11T09:58:50.022568Z"},"id":"pKNOU03o-CCd","papermill":{"duration":0.026055,"end_time":"2022-09-11T09:58:50.025937","exception":false,"start_time":"2022-09-11T09:58:49.999882","status":"completed"},"tags":[]},"outputs":[],"source":["#accuracy score on training data\n","X_train_prediction = classifier.predict(X_train)\n","training_data_accuracy=accuracy_score(X_train_prediction, Y_train)\n","#comparing prediction made by model with the original label"]},{"cell_type":"code","execution_count":19,"id":"024e5bf7","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.046882Z","iopub.status.busy":"2022-09-11T09:58:50.046461Z","iopub.status.idle":"2022-09-11T09:58:50.052086Z","shell.execute_reply":"2022-09-11T09:58:50.050868Z"},"id":"nM1Oc0kXAp41","outputId":"bbab7fe3-3fa6-4fd6-b581-0a0ce8aaa735","papermill":{"duration":0.01898,"end_time":"2022-09-11T09:58:50.054461","exception":false,"start_time":"2022-09-11T09:58:50.035481","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy score of the training data :  0.8105906313645621\n"]}],"source":["print('Accuracy score of the training data : ',training_data_accuracy)"]},{"cell_type":"code","execution_count":20,"id":"ebd640b1","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.075442Z","iopub.status.busy":"2022-09-11T09:58:50.075036Z","iopub.status.idle":"2022-09-11T09:58:50.083618Z","shell.execute_reply":"2022-09-11T09:58:50.082697Z"},"id":"49z3t0sNKbpb","papermill":{"duration":0.02165,"end_time":"2022-09-11T09:58:50.085757","exception":false,"start_time":"2022-09-11T09:58:50.064107","status":"completed"},"tags":[]},"outputs":[],"source":["#accuracy score on test data\n","X_test_prediction = classifier.predict(X_test)\n","test_data_accuracy=accuracy_score(X_test_prediction, Y_test)\n","#comparing prediction made by model with the original label"]},{"cell_type":"code","execution_count":21,"id":"5b831901","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.10699Z","iopub.status.busy":"2022-09-11T09:58:50.106556Z","iopub.status.idle":"2022-09-11T09:58:50.112303Z","shell.execute_reply":"2022-09-11T09:58:50.111168Z"},"id":"dD9__njJLDZj","outputId":"dd2ea7c3-8343-4422-aeba-f0cf2471d503","papermill":{"duration":0.019431,"end_time":"2022-09-11T09:58:50.114707","exception":false,"start_time":"2022-09-11T09:58:50.095276","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy score of the testing data :  0.8048780487804879\n"]}],"source":["print('Accuracy score of the testing data : ',test_data_accuracy)"]},{"cell_type":"markdown","id":"94ece0c1","metadata":{"id":"mVb_RftdMFoj","papermill":{"duration":0.009367,"end_time":"2022-09-11T09:58:50.133788","exception":false,"start_time":"2022-09-11T09:58:50.124421","status":"completed"},"tags":[]},"source":["Making a predictive system"]},{"cell_type":"code","execution_count":22,"id":"dc9c0bb4","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.154991Z","iopub.status.busy":"2022-09-11T09:58:50.154155Z","iopub.status.idle":"2022-09-11T09:58:50.205272Z","shell.execute_reply":"2022-09-11T09:58:50.204108Z"},"id":"_oW0Ln-fPM9_","outputId":"233ddba3-eb64-4c1d-9bef-94d4937f4e4e","papermill":{"duration":0.064378,"end_time":"2022-09-11T09:58:50.207744","exception":false,"start_time":"2022-09-11T09:58:50.143366","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th>Predicted</th>\n","      <th>0</th>\n","      <th>1</th>\n","      <th>All</th>\n","    </tr>\n","    <tr>\n","      <th>True</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>17</td>\n","      <td>21</td>\n","      <td>38</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>3</td>\n","      <td>82</td>\n","      <td>85</td>\n","    </tr>\n","    <tr>\n","      <th>All</th>\n","      <td>20</td>\n","      <td>103</td>\n","      <td>123</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["Predicted   0    1  All\n","True                   \n","0          17   21   38\n","1           3   82   85\n","All        20  103  123"]},"execution_count":22,"metadata":{},"output_type":"execute_result"}],"source":["#import confusion_matrix\n","from sklearn.metrics import confusion_matrix\n","#let us get the predictions using the classifier we had fit above\n","y_pred = classifier.predict(X_test)\n","confusion_matrix(Y_test,y_pred)\n","pd.crosstab(Y_test, y_pred, rownames=['True'], colnames=['Predicted'], margins=True)"]},{"cell_type":"code","execution_count":23,"id":"ae5d8101","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.229241Z","iopub.status.busy":"2022-09-11T09:58:50.228819Z","iopub.status.idle":"2022-09-11T09:58:50.245024Z","shell.execute_reply":"2022-09-11T09:58:50.24388Z"},"papermill":{"duration":0.029792,"end_time":"2022-09-11T09:58:50.247369","exception":false,"start_time":"2022-09-11T09:58:50.217577","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Loan_ID</th>\n","      <th>Gender</th>\n","      <th>Married</th>\n","      <th>Dependents</th>\n","      <th>Education</th>\n","      <th>Self_Employed</th>\n","      <th>ApplicantIncome</th>\n","      <th>CoapplicantIncome</th>\n","      <th>LoanAmount</th>\n","      <th>Loan_Amount_Term</th>\n","      <th>Credit_History</th>\n","      <th>Property_Area</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>376</td>\n","      <td>0</td>\n","      <td>203</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>306</td>\n","      <td>60</td>\n","      <td>81</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>139</td>\n","      <td>0</td>\n","      <td>26</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>90</td>\n","      <td>160</td>\n","      <td>73</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>381</td>\n","      <td>0</td>\n","      <td>94</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>609</th>\n","      <td>609</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>125</td>\n","      <td>0</td>\n","      <td>29</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>610</th>\n","      <td>610</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>275</td>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>611</th>\n","      <td>611</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>431</td>\n","      <td>3</td>\n","      <td>162</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>612</th>\n","      <td>612</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>422</td>\n","      <td>0</td>\n","      <td>132</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>613</th>\n","      <td>613</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>306</td>\n","      <td>0</td>\n","      <td>86</td>\n","      <td>8</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>614 rows Ã— 12 columns</p>\n","</div>"],"text/plain":["     Loan_ID  Gender  Married  Dependents  Education  Self_Employed  \\\n","0          0       1        0           0          0              0   \n","1          1       1        1           1          0              0   \n","2          2       1        1           0          0              1   \n","3          3       1        1           0          1              0   \n","4          4       1        0           0          0              0   \n","..       ...     ...      ...         ...        ...            ...   \n","609      609       0        0           0          0              0   \n","610      610       1        1           3          0              0   \n","611      611       1        1           1          0              0   \n","612      612       1        1           2          0              0   \n","613      613       0        0           0          0              1   \n","\n","     ApplicantIncome  CoapplicantIncome  LoanAmount  Loan_Amount_Term  \\\n","0                376                  0         203                 8   \n","1                306                 60          81                 8   \n","2                139                  0          26                 8   \n","3                 90                160          73                 8   \n","4                381                  0          94                 8   \n","..               ...                ...         ...               ...   \n","609              125                  0          29                 8   \n","610              275                  0           7                 5   \n","611              431                  3         162                 8   \n","612              422                  0         132                 8   \n","613              306                  0          86                 8   \n","\n","     Credit_History  Property_Area  \n","0                 1              2  \n","1                 1              0  \n","2                 1              2  \n","3                 1              2  \n","4                 1              2  \n","..              ...            ...  \n","609               1              0  \n","610               1              0  \n","611               1              2  \n","612               1              2  \n","613               0              1  \n","\n","[614 rows x 12 columns]"]},"execution_count":23,"metadata":{},"output_type":"execute_result"}],"source":["X"]},{"cell_type":"code","execution_count":24,"id":"dc9b20dd","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.270183Z","iopub.status.busy":"2022-09-11T09:58:50.269544Z","iopub.status.idle":"2022-09-11T09:58:50.279727Z","shell.execute_reply":"2022-09-11T09:58:50.278307Z"},"id":"Aplgnc4DMK5H","outputId":"c71f54e8-fbb8-4c2e-f5c3-dc90259b6ed1","papermill":{"duration":0.024727,"end_time":"2022-09-11T09:58:50.282595","exception":false,"start_time":"2022-09-11T09:58:50.257868","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[1]\n","The person will take loan\n"]},{"name":"stderr","output_type":"stream","text":["/opt/conda/lib/python3.7/site-packages/sklearn/base.py:451: UserWarning: X does not have valid feature names, but SVC was fitted with feature names\n","  \"X does not have valid feature names, but\"\n"]}],"source":["input_data=[[0,1,0,0,0,0,376,0,203,8,1,2]]\n","\n","prediction = classifier.predict(input_data)\n","print(prediction)\n","if (prediction[0] == 0):\n","  print('The person will not take loan')\n","else:\n","  print('The person will take loan')"]},{"cell_type":"code","execution_count":25,"id":"e29ea2b1","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.305823Z","iopub.status.busy":"2022-09-11T09:58:50.305407Z","iopub.status.idle":"2022-09-11T09:58:50.313313Z","shell.execute_reply":"2022-09-11T09:58:50.312297Z"},"id":"Fee8EsRSVYlp","outputId":"91fd3236-2448-469c-c44d-e95d9e29ae3a","papermill":{"duration":0.024435,"end_time":"2022-09-11T09:58:50.317901","exception":false,"start_time":"2022-09-11T09:58:50.293466","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[1]\n","The person will take loan\n"]},{"name":"stderr","output_type":"stream","text":["/opt/conda/lib/python3.7/site-packages/sklearn/base.py:451: UserWarning: X does not have valid feature names, but SVC was fitted with feature names\n","  \"X does not have valid feature names, but\"\n"]}],"source":["input_data=[[2,1,1,0,0,1,139,0,26,8,1,2]]\n","\n","prediction = classifier.predict(input_data)\n","print(prediction)\n","if (prediction[0] == 0):\n","  print('The person will not take loan')\n","else:\n","  print('The person will take loan')\n"]},{"cell_type":"code","execution_count":26,"id":"a0de46b4","metadata":{"execution":{"iopub.execute_input":"2022-09-11T09:58:50.341035Z","iopub.status.busy":"2022-09-11T09:58:50.340621Z","iopub.status.idle":"2022-09-11T09:58:50.348304Z","shell.execute_reply":"2022-09-11T09:58:50.347144Z"},"id":"UFnK3aZvtuvb","outputId":"da63ce9b-96d4-42c6-cd41-406f983ae169","papermill":{"duration":0.022251,"end_time":"2022-09-11T09:58:50.350846","exception":false,"start_time":"2022-09-11T09:58:50.328595","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[0]\n","The person will not take loan\n"]},{"name":"stderr","output_type":"stream","text":["/opt/conda/lib/python3.7/site-packages/sklearn/base.py:451: UserWarning: X does not have valid feature names, but SVC was fitted with feature names\n","  \"X does not have valid feature names, but\"\n"]}],"source":["input_data=[[613,0,0,0,0,1,306,0,86,8,0,1]]\n","\n","prediction = classifier.predict(input_data)\n","print(prediction)\n","if (prediction[0] == 0):\n","  print('The person will not take loan')\n","else:\n","  print('The person will take loan')"]},{"cell_type":"code","execution_count":null,"id":"c66b7934","metadata":{"papermill":{"duration":0.010273,"end_time":"2022-09-11T09:58:50.371745","exception":false,"start_time":"2022-09-11T09:58:50.361472","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.12"},"papermill":{"default_parameters":{},"duration":12.610289,"end_time":"2022-09-11T09:58:51.103408","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-09-11T09:58:38.493119","version":"2.3.4"}},"nbformat":4,"nbformat_minor":5}